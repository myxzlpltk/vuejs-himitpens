<!DOCTYPE html>
<html>
<head>
	<title>VueJS</title>
	<link rel="stylesheet" type="text/css" href="bootstrap.min.css">
</head>
<body class="bg-light">

	<div class="container py-5" id="app">
		<img :src="`https://img.youtube.com/vi/${getYoutubeID(url)}/hqdefault.jpg`" class="img-fluid d-block mx-auto mb-4">
		<div id="youtube-url">
			<div class="form-group">
				<input type="text" name="url" class="form-control" id="search" placeholder="URL Youtube" v-model="url">
			</div>
		</div>
		<hr>
		<div id="search-box">
			<div class="form-group">
				<div class="input-group mb-3">
					<input type="text" name="query" class="form-control" id="search" placeholder="Ketik pencarian" v-model="query">
					<div class="input-group-append">
						<button class="btn btn-outline-secondary" type="button" @click="clear">Bersihkan</button>
					</div>
				</div>
			</div>
		</div>
		<nav aria-label="Halaman navigasi">
			<ul class="pagination justify-content-center">
				<li class="page-item" :class="{disabled: !pagination.first}">
					<button class="page-link">Awal</button>
				</li>
				<li class="page-item" :class="{disabled: !pagination.prev}">
					<button class="page-link">Sebelumnya</button>
				</li>
				<li class="page-item" :class="{disabled: !pagination.next}">
					<button class="page-link">Selanjutnya</button>
				</li>
				<li class="page-item" :class="{disabled: !pagination.last}">
					<button class="page-link">Akhir</button>
				</li>
			</ul>
		</nav>
	</div>

	<script type="text/javascript" src="vue.js"></script>
	<script type="text/javascript">
		function debounce(func, wait, immediate) {
			var timeout;
			return function() {
				var context = this, args = arguments;
				var later = function() {
					timeout = null;
					if (!immediate) func.apply(context, args);
				};
				var callNow = immediate && !timeout;
				clearTimeout(timeout);
				timeout = setTimeout(later, wait);
				if (callNow) func.apply(context, args);
			};
		};

		var app = new Vue({
			el: '#app',
			data: {
				url: 'https://www.youtube.com/watch?v=klnvttPfOUM',
				query: '',
				pagination: {
					first: null,
					prev: null,
					next: null,
					last: null,
					page: null,
					total: 0
				},
				last_query: ''
			},
			computed: {
				getYoutubeID(url){
					return function(url){
						youtubeID = url.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&]+)/);

						if(youtubeID){
							return youtubeID[1];
						}
						else{
							return false;
						}
					}
				}
			},
			methods: {
				clear(event){
					this.query = '';
					event.target.blur();
				}
			},
			watch: {
				query: debounce(async function(query){
					query = query.trim();
					if(query.length >= 1 && this.last_query != query){
						this.last_query = query;
					}
				}, 250)
			}
		});
	</script>
</body>
</html>